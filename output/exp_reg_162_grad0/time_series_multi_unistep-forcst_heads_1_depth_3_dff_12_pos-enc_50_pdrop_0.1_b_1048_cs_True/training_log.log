INFO:training log:model hyperparameters from the config file: {'num_layers': 1, 'num_heads': 1, 'd_model': 3, 'dff': 12, 'rate': 0.1, 'maximum_position_encoding_baseline': 50, 'maximum_position_encoding_smc': 'None'}
INFO:training log:smc hyperparameters from the config file: {'num_particles': 5, 'noise_encoder': 'False', 'noise_SMC_layer': 'True', 'sigma': 0.05}
INFO:training log:training the baseline Transformer on a time-series dataset...
INFO:training log:number of training samples: 336290
INFO:training log:steps per epoch:320
INFO:training log:training a baseline transformer with positional encoding...
INFO:training log:Epoch 1/30
WARNING:tensorflow:Layer transformer is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.

If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.

To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.

INFO:training log:train loss: 0.8328185081481934 - val loss: 0.5987477898597717
INFO:training log:Time taken for 1 epoch: 21.46227216720581 secs

INFO:training log:Epoch 2/30
INFO:training log:train loss: 0.3935449719429016 - val loss: 0.2781917154788971
INFO:training log:Time taken for 1 epoch: 21.269108295440674 secs

INFO:training log:Epoch 3/30
INFO:training log:train loss: 0.3023045063018799 - val loss: 0.2550806701183319
INFO:training log:Time taken for 1 epoch: 20.907305240631104 secs

INFO:training log:Epoch 4/30
INFO:training log:train loss: 0.3255670964717865 - val loss: 0.25308236479759216
INFO:training log:Time taken for 1 epoch: 20.54994225502014 secs

INFO:training log:Epoch 5/30
INFO:training log:train loss: 0.31175562739372253 - val loss: 0.2527964413166046
INFO:training log:Time taken for 1 epoch: 20.613853454589844 secs

INFO:training log:Epoch 6/30
INFO:training log:train loss: 0.33913397789001465 - val loss: 0.2477017194032669
INFO:training log:Time taken for 1 epoch: 20.838927268981934 secs

INFO:training log:Epoch 7/30
INFO:training log:train loss: 0.3253052234649658 - val loss: 0.23778513073921204
INFO:training log:Time taken for 1 epoch: 21.085750818252563 secs

INFO:training log:Epoch 8/30
INFO:training log:train loss: 0.20223742723464966 - val loss: 0.11085295677185059
INFO:training log:Time taken for 1 epoch: 20.805473804473877 secs

INFO:training log:Epoch 9/30
INFO:training log:train loss: 0.2221118062734604 - val loss: 0.09020634740591049
INFO:training log:Time taken for 1 epoch: 20.935303211212158 secs

INFO:training log:Epoch 10/30
INFO:training log:train loss: 0.20067374408245087 - val loss: 0.08509503304958344
INFO:training log:Time taken for 1 epoch: 21.14370560646057 secs

INFO:training log:Epoch 11/30
INFO:training log:train loss: 0.19101178646087646 - val loss: 0.08920205384492874
INFO:training log:Time taken for 1 epoch: 20.863614320755005 secs

INFO:training log:Epoch 12/30
INFO:training log:train loss: 0.19091133773326874 - val loss: 0.0913722887635231
INFO:training log:Time taken for 1 epoch: 20.761539936065674 secs

INFO:training log:Epoch 13/30
INFO:training log:train loss: 0.19330543279647827 - val loss: 0.09197761863470078
INFO:training log:Time taken for 1 epoch: 20.816853523254395 secs

INFO:training log:Epoch 14/30
INFO:training log:train loss: 0.17568339407444 - val loss: 0.08100754022598267
INFO:training log:Time taken for 1 epoch: 20.603771924972534 secs

INFO:training log:Epoch 15/30
INFO:training log:train loss: 0.19327132403850555 - val loss: 0.07770521193742752
INFO:training log:Time taken for 1 epoch: 21.026613473892212 secs

INFO:training log:Epoch 16/30
INFO:training log:train loss: 0.17772246897220612 - val loss: 0.07679861783981323
INFO:training log:Time taken for 1 epoch: 20.77172827720642 secs

INFO:training log:Epoch 17/30
INFO:training log:train loss: 0.2020116001367569 - val loss: 0.07112417370080948
INFO:training log:Time taken for 1 epoch: 21.12326145172119 secs

INFO:training log:Epoch 18/30
INFO:training log:train loss: 0.19498680531978607 - val loss: 0.07505665719509125
INFO:training log:Time taken for 1 epoch: 21.07865309715271 secs

INFO:training log:Epoch 19/30
INFO:training log:train loss: 0.17077910900115967 - val loss: 0.06711834669113159
INFO:training log:Time taken for 1 epoch: 21.059788465499878 secs

INFO:training log:Epoch 20/30
INFO:training log:train loss: 0.19648359715938568 - val loss: 0.06715105473995209
INFO:training log:Time taken for 1 epoch: 20.845280408859253 secs

INFO:training log:Epoch 21/30
INFO:training log:train loss: 0.1882479339838028 - val loss: 0.0663045197725296
INFO:training log:Time taken for 1 epoch: 20.97497296333313 secs

INFO:training log:Epoch 22/30
INFO:training log:train loss: 0.17070253193378448 - val loss: 0.0690024122595787
INFO:training log:Time taken for 1 epoch: 20.854273080825806 secs

INFO:training log:Epoch 23/30
INFO:training log:train loss: 0.20412440598011017 - val loss: 0.06853092461824417
INFO:training log:Time taken for 1 epoch: 20.856476306915283 secs

INFO:training log:Epoch 24/30
INFO:training log:train loss: 0.19302864372730255 - val loss: 0.0646856427192688
INFO:training log:Time taken for 1 epoch: 20.88863468170166 secs

INFO:training log:Epoch 25/30
INFO:training log:train loss: 0.18185721337795258 - val loss: 0.06777672469615936
INFO:training log:Time taken for 1 epoch: 20.76856279373169 secs

INFO:training log:Epoch 26/30
INFO:training log:train loss: 0.193476140499115 - val loss: 0.06707759201526642
INFO:training log:Time taken for 1 epoch: 20.604286432266235 secs

INFO:training log:Epoch 27/30
INFO:training log:train loss: 0.19212552905082703 - val loss: 0.06456132233142853
INFO:training log:Time taken for 1 epoch: 21.08743190765381 secs

INFO:training log:Epoch 28/30
INFO:training log:train loss: 0.19883862137794495 - val loss: 0.0650838315486908
INFO:training log:Time taken for 1 epoch: 20.91730260848999 secs

INFO:training log:Epoch 29/30
INFO:training log:train loss: 0.17616237699985504 - val loss: 0.06421995162963867
INFO:training log:Time taken for 1 epoch: 20.647677898406982 secs

INFO:training log:Epoch 30/30
INFO:training log:train loss: 0.16994838416576385 - val loss: 0.06603724509477615
INFO:training log:Time taken for 1 epoch: 21.126128673553467 secs

INFO:training log:total training time for 30 epochs:627.2985689640045
INFO:training log:saving loss and metrics information...
INFO:training log:saving model output in .npy files...
INFO:training log:training of a classic Transformer for a time-series dataset done...
INFO:training log:>>>-------------------------------------------------------------------------------------------------------------------------------------------------------------<<<
